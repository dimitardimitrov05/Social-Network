@model Connectly.Models.PostViewModels.IndexViewModel
@{
    ViewData["Title"] = "Home Page";
}

<div class="container mx-auto px-4">
    <div class="grid grid-cols-1 lg:grid-cols-8 gap-4">
        <!-- Main content (Post section) -->
        <div class="col-span-8 lg:col-span-6">
            <div class="mt-4">
                <!-- New Post -->
                <div class="bg-white shadow rounded-lg mb-4 p-4">
                    <form method="post" asp-controller="Posts" asp-action="Add">
                        <textarea class="form-control block w-full border rounded p-2 mb-4" rows="2" asp-for="PostContent" placeholder="What's on your mind?"></textarea>
                        <div class="flex justify-between items-center">
                            <div>
                                <select class="border-none text-blue-500" asp-for="PostVisibility">
                                    <option value="" disabled selected>Who can see this post</option>
                                    <option value="Friends">Friends</option>
                                    <option value="Friends of friends">Friends of friends</option>
                                    <option value="Public">Public</option>
                                </select>
                            </div>
                            <button type="submit" class="bg-blue-500 text-white py-2 px-4 rounded-full">Post</button>
                        </div>
                    </form>
                </div>

                <!-- User Posts -->
                @foreach (var post in Model.Posts)
                {
                    <div class="bg-white shadow rounded-lg mb-4 p-4">
                        <div class="flex items-center mb-4">
                            @if (post.UserProfilePicture is not null)
                            {
                                <a asp-controller="Account" asp-action="ProfileInfo" asp-route-id="@post.UserId" class="inline-block">
                                    <img src="@post.UserProfilePicture" class="h-10 w-10 rounded-full">
                                </a>
                            }
                            else
                            {
                                <a asp-controller="Account" asp-action="ProfileInfo" asp-route-id="@post.UserId" class="inline-block">
                                    <img src="https://cdn.pixabay.com/photo/2018/11/13/21/43/avatar-3814049_1280.png" class="h-10 w-10 rounded-full">
                                </a>
                            }
                            <div class="ml-3">
                                <a asp-controller="Account" asp-action="ProfileInfo" asp-route-id="@post.UserId" class="text-black font-bold text-sm">
                                    @post.UserFirstName @post.UserLastName
                                </a>
                                <p class="text-gray-500 text-xs">@post.CreationOfPost.ToString("dd/MM/yyyy")</p>
                            </div>
                            @if (post.UserId == Model.CurrentUserId)
                            {
                                <form class="ml-auto">
                                    <button class="bg-red-500 text-white py-1 px-2 rounded-full" asp-action="Delete" asp-controller="Posts" asp-route-id="@post.Id">Delete</button>
                                </form>
                            }
                        </div>
                        <p class="whitespace-pre-wrap">@post.Text</p>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="fixed inset-0 z-50 overflow-y-auto hidden" id="invite">
        <div class="flex items-center justify-center min-h-screen">
            <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
                <div class="flex justify-between items-center">
                    <h5 class="text-xl font-bold">Creating an invitation</h5>
                    <button type="button" id="closeModal" class="text-2xl" onclick="document.getElementById('invite').classList.add('hidden')">
                        &times;
                    </button>
                </div>
                <div class="mt-4">
                    <form method="post">
                        <input type="text" class="block w-full border rounded p-2 mb-4" asp-for="EmailOfReceiver" placeholder="Write the email of your friend">
                        <button type="submit" asp-controller="Invitations" asp-action="Add" class="bg-blue-500 text-white py-2 px-4 rounded float-right">Send</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
